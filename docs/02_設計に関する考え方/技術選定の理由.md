
# 技術選定の理由

## 0. 選定した技術スタック（全体像）

本プロジェクトで採用した技術は、概ね以下の通りである。

### フロントエンド

* **Next.js（App Router）**
* **TypeScript**
* **shadcn/ui（UIコンポーネント）**

### バックエンド

* **Python**（Web API）
* **FastAPI**（APIフレームワーク）
* **SQLAlchemy**（ORM）
* （マイグレーション：**Alembic** を前提）
* **uv**（バージョン管理ツール）

※バックエンド設計は、ドメイン駆動設計（DDD）とヘキサゴナルアーキテクチャ（Ports and Adapters）の考え方に沿って、`domain / application / adapters` の責務分離を行う方針とした。

### データベース

* **RDB（PostgreSQL を想定）**

### 認証・認可（AuthN / AuthZ）

* **Auth0**

  * ログイン（認証）
  * 権限（Role / Permission）を含む認可設計の外部化

### インフラ・運用（ローカル含む）

* **Docker / Docker Compose**（ローカル開発環境の再現性確保）
* （必要に応じて）**Nginx**（リバースプロキシ／将来的な本番想定）
* `.env` による設定管理（環境変数）

### 代替案として検討したもの

* **Google スプレッドシート + Google Apps Script**（最短完成の候補）

---

## 1. 技術選定における基本方針

本プロジェクトの技術選定において最も重視したのは、**長期運用と変更耐性**である。
人事考課は、評価項目・運用ルール・権限構造が継続的に変更されうる業務であり、短期的に「動くもの」を作るだけでは運用に耐えない。したがって、短期の実装容易性よりも、仕様変更が入っても破綻しにくい構造を優先した。

また、人事考課システムは「入力」「集計」だけでなく、「履歴の追跡」や「育成への活用」までを射程に入れる必要がある。これを踏まえ、データの一貫性・権限の厳密性・将来の拡張可能性を重視した。

---

## 2. Googleスプレッドシート（Apps Script）を中核にしなかった理由

最短での完成だけを狙うなら、GoogleスプレッドシートとApps Scriptを中心に構成することは現実的である。導入が容易で、現行運用（紙・スプレッドシート）からの移行も小さい。

しかし本プロジェクトでは、以下の理由から採用しなかった。

* 業務ルールやデータ構造が増えたときに、**拡張性・柔軟性に乏しい**
* 権限・閲覧制御など、評価業務に必須の要件を厳密に実装しづらく、**セキュリティ要件を担保しにくい**
* 運用が属人化しやすく、後から仕様が増えた際に、実装や依存関係がブラックボックス化しやすい

以上より、スプレッドシートは「短期の便利さ」はある一方、プロジェクトの目的（長期運用・育成活用）に対しては限界があると判断した。

---

## 3. バックエンド技術（FastAPI + RDB）を選んだ理由

### 3.1 バックエンドの主目的：権限と整合性の担保

バックエンドで最も重視したのは、**権限関係を含むセキュリティ**である。
人事考課では「誰が」「誰を」「どの段階で」「どこまで」操作できるかが本質であり、これを曖昧にすると、業務として成立しない。

そのため、Web APIとして責務を明確化し、RDBでデータ整合性を担保しながら運用できる構成を採用した。

### 3.2 FastAPI（Python）を選んだ理由

* APIの構成が明確で、型・スキーマを通じて仕様を表現しやすい
* 業務ルール（権限、進捗、集計）を段階的に実装しやすい
* DDD / ヘキサゴナルの責務分離（層構造）を当てはめやすい

---

## 4. DDD / ヘキサゴナルを選んだ理由（過去の反省に基づく）

以前は、CRUD中心のデータ主導（例：`crud / models / services`など）で設計していたが、機能追加とともに **servicesが膨大になり、依存関係が絡まり、修正が困難**になった経験がある。
この反省から、業務ルールを中心に置き、技術的関心（DB・Web・外部サービス）を周辺に追いやる構造が必要だと判断した。

そこで、業務ルールを**ドメイン層**に集約し、外部要素（DB、Auth、HTTP）を**アダプタ**として接続するために、DDDとヘキサゴナルアーキテクチャ（Ports and Adapters）の採用を選択した。

なお、ヘキサゴナルを採用した直接のきっかけとして、当時参照した情報の中で「このタイプの業務アプリに適している」と判断した点もある（ただし、最終的な採否は上記の反省と目的に基づいている）。

---

## 5. 認証・認可（Auth0）をSaaSに任せた理由

認証・認可は、コア業務（人事考課のルール）ではない一方で、実装を誤ると重大なリスクにつながる領域である。
少人数開発で、限られた工数の中で安全性を担保するには、自前実装よりも、実績のあるSaaSに委ねる方が合理的だと判断した。

* コアドメイン以外をSaaSに委ねることで、開発リソースを評価業務の実装に集中できる
* 自前よりも高いセキュリティ水準を期待できる
* 権限（Role/Permission）設計を、アプリの責務から切り離しやすい

---

## 6. フロントエンド（Next.js + shadcn/ui）を選んだ理由

フロントエンドで重視したのは、**UI/UXの操作導線**である。
人事考課は入力作業の比重が大きく、操作性が低いと現場導入が進まない。そのため、画面構成を部品化し、改善を繰り返せる構成として Next.js を採用した。

実装上、技術的に詰まる点は少なかった一方で、UI調整や画面の作り込みに時間がかかり、結果として全体工数のボトルネックになった。

---

## 7. インフラ（Docker/Compose）を採用した理由

少人数開発では、環境差分がそのまま開発停止要因になる。
そこで、ローカル環境を含めて再現性を確保するために Docker / Docker Compose を採用し、以下を狙った。

* 開発環境の再現性（後続が起動できる）
* 依存サービス（DB等）を含めた統一
* 設定（env）の整理と可視化

---

## 8. 振り返り（技術選定の評価）

技術選定の方向性（長期運用・変更耐性の重視）は正しかったと考えている。
一方で、DDD / ヘキサゴナルの導入が遅く、設計理解と実装に必要な時間を確保できなかった点は大きな反省である。より早い段階で設計の型を確立できていれば、完成度は異なっていた可能性がある。

---

## 9. 後続への助言（技術選定に関する教訓）

少人数で開発する場合、選定した技術について**メンバー全員が最低限の理解を持つこと**が重要である。
高度な設計は、理解が共有されないと負債になりうる。技術選定は、技術そのものだけでなく「チームが扱えるか」という観点まで含めて行うべきである。

---


